# CursorHelper

`CursorHelper` 是一款基于 **AutoHotkey v2** 开发的高级效率工具，专为 **Cursor AI** 编译器深度定制。它通过创新的 `CapsLock+` 交互方案，将常用的 AI 操作、代码管理与系统功能集成到一个极速响应的悬浮面板中。

---


## ✨ 核心特色

- **🚀 独创 CapsLock+ 交互**：
  - **无感化设计**：单击 `CapsLock` 仍为原有大小写切换。
  - **指令模式**：长按 `CapsLock` 瞬间唤出 AI 快捷面板，手指无需离开主键盘区即可完成复杂指令。
- **📋 智能连续剪贴板 (Append Copy)**：
  - 支持多次按下 `CapsLock + C` 将不同片段“追加”到缓存，再通过一次 `V` 键合并发送给 Cursor，解决多次搬运代码的痛苦。
- **🧠 深度集成 AI 指令**：
  - 一键触发：**解释代码 (Explain)**、**重构优化 (Refactor)**、**修复错误 (Fix)**、**代码评审 (Review)**。
  - 脚本会自动处理编码转换（URI Encoding），确保各种复杂字符和缩进准确传递。
- **🎨 极致视觉与性能**：
  - 基于 AHK v2 GUI 开发的沉浸式面板，支持**暗黑/明亮主题**自适应。
  - 完美支持多显示器环境，面板始终在鼠标附近弹出。
- **⚙️ 可视化配置管理**：
  - 内置 `CapsLock + Q` 设置界面。用户无需修改代码，即可自定义快捷键、AI 提示词 (Prompts) 及系统路径。

---

## 🛠️ 安装与使用方法

### 1. 前置准备
- 操作系统：Windows 10 / 11。
- 必须安装 **[AutoHotkey v2.0+](https://www.autohotkey.com/)**。
- 正在使用 **Cursor** 编辑器。

### 2. 部署步骤
1. 下载本项目中的 `CursorHelper.ahk` 文件。
2. （可选）将图标文件 `cursor_helper.ico` 放入同一文件夹，以获得更美观的托盘体验。
3. **右键点击 -> 以管理员身份运行**（脚本需要管理员权限以操作 Cursor 窗口和模拟键盘输入）。

### 3. 操作指令表

| 按键组合 | 功能描述 |
| :--- | :--- |
| **长按 CapsLock** | 弹出功能面板 (松开按键或点击面板外可隐藏) |
| **CapsLock + C** | **追加复制**：将选中的文本加入合并队列 |
| **CapsLock + V** | **合并粘贴**：将所有复制的内容发送给 Cursor |
| **CapsLock + Q** | 打开 **设置中心**：自定义 Prompts 和快捷键 |
| **面板内 E / R / F** | 快速操作：**E**xplain(解释) / **R**efactor(重构) / **F**ix(修复) |
| **CapsLock + Z** | 唤起语音输入辅助（视配置而定） |

---

## 📖 技术实现

脚本的核心优势在于对系统底层的细致处理：
- **JScript 编码引擎**：内置 JavaScript 接口进行 `encodeURIComponent` 处理，解决 AHK 原生编码兼容性问题。
- **INI 持久化**：所有配置动态保存于 `CursorShortcut.ini`，确保脚本关闭后偏好不丢失。
- **多重权限检查**：自动检测 `A_IsAdmin` 状态，确保在不同权限级别的窗口中均能正常工作。

---

## 🤝 贡献与反馈

- **Star**：如果你觉得好用，请给本项目点个 Star。
- **Issue**：发现 Bug 或有更强的 Prompt 建议？欢迎提交 Issue。

 
## 🛑 法律与版权申明
在下载或使用本项目之前，请务必知悉：
1. **不可商用**：本项目及其源代码仅供个人学习和编码效率提升使用。**严禁**将本脚本用于任何形式的商业盈利行为，包括但不限于打包销售、作为收费服务的插件或有偿代部署。
2. **禁止恶意修改**：严禁在脚本中植入任何后门、病毒、广告追踪或恶意破坏系统逻辑的代码。如需二次分发修改版，必须保留原作者信息并以开源形式发布。
3. **免责声明**：脚本涉及模拟按键与系统进程操作。使用者需自行承担因使用本工具可能导致的软件冲突、数据意外丢失或法律责任。
---

